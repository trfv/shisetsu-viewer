query reservations(
  $offset: Int
  $limit: Int
  $prefecture: prefecture = "PREFECTURE_TOKYO"
  $municipality: [String!]
  $startDate: date
  $endDate: date
  $isHoliday: Boolean
  $reservationStatus1: jsonb = null
  $reservationStatus2: jsonb = null
  $reservationStatus3: jsonb = null
  $reservationStatus4: jsonb = null
) {
  reservations(
    offset: $offset
    limit: $limit
    where: {
      _and: {
        institution: { prefecture: { _eq: $prefecture }, municipality: { _in: $municipality } }
        date: { _gte: $startDate, _lte: $endDate }
        is_holiday: { _eq: $isHoliday }
      }
      _or: [
        { reservation: { _contains: $reservationStatus1 } }
        { reservation: { _contains: $reservationStatus2 } }
        { reservation: { _contains: $reservationStatus3 } }
        { reservation: { _contains: $reservationStatus4 } }
      ]
    }
    order_by: { date: asc }
  ) {
    id
    date
    reservation
    updated_at
    institution {
      id
      municipality
      building
      institution
    }
  }
  reservations_aggregate(
    where: {
      _and: {
        institution: { prefecture: { _eq: $prefecture }, municipality: { _in: $municipality } }
        date: { _gte: $startDate, _lte: $endDate }
        is_holiday: { _eq: $isHoliday }
      }
      _or: [
        { reservation: { _contains: $reservationStatus1 } }
        { reservation: { _contains: $reservationStatus2 } }
        { reservation: { _contains: $reservationStatus3 } }
        { reservation: { _contains: $reservationStatus4 } }
      ]
    }
  ) {
    aggregate {
      count
    }
  }
}
