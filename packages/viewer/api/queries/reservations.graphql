query reservations(
  $offset: Int
  $limit: Int
  $prefecture: prefecture = null
  $municipality: [String!]
  $isAvailableStrings: availavility_division = null
  $isAvailableWoodwind: availavility_division = null
  $isAvailableBrass: availavility_division = null
  $isAvailablePercussion: availavility_division = null
  $institutionSizes: [String!] = null
  $startDate: date
  $endDate: date
  $isHoliday: Boolean
  $isMorningVacant: Boolean
  $isAfternoonVacant: Boolean
  $isEveningVacant: Boolean
) {
  searchable_reservations(
    offset: $offset
    limit: $limit
    where: {
      _and: {
        institution: {
          prefecture: { _eq: $prefecture }
          municipality: { _in: $municipality }
          is_available_strings: { _eq: $isAvailableStrings }
          is_available_woodwind: { _eq: $isAvailableWoodwind }
          is_available_brass: { _eq: $isAvailableBrass }
          is_available_percussion: { _eq: $isAvailablePercussion }
          institution_size: { _in: $institutionSizes }
        }
        date: { _gte: $startDate, _lte: $endDate }
        is_morning_vacant: { _eq: $isMorningVacant }
        is_afternoon_vacant: { _eq: $isAfternoonVacant }
        is_evening_vacant: { _eq: $isEveningVacant }
        is_holiday: { _eq: $isHoliday }
      }
    }
    order_by: { date: asc }
  ) {
    id
    reservation {
      id
      date
      reservation
      updated_at
    }
    institution {
      id
      municipality
      building
      institution
      institution_size
    }
  }
  searchable_reservations_aggregate(
    where: {
      _and: {
        institution: {
          prefecture: { _eq: $prefecture }
          municipality: { _in: $municipality }
          is_available_strings: { _eq: $isAvailableStrings }
          is_available_woodwind: { _eq: $isAvailableWoodwind }
          is_available_brass: { _eq: $isAvailableBrass }
          is_available_percussion: { _eq: $isAvailablePercussion }
          institution_size: { _in: $institutionSizes }
        }
        date: { _gte: $startDate, _lte: $endDate }
        is_morning_vacant: { _eq: $isMorningVacant }
        is_afternoon_vacant: { _eq: $isAfternoonVacant }
        is_evening_vacant: { _eq: $isEveningVacant }
        is_holiday: { _eq: $isHoliday }
      }
    }
  ) {
    aggregate {
      count
    }
  }
}
